# 浏览器的渲染机制

## dom tree

### 当页面的html标签，经过parse的过程形成一个dom树的结构

## css rule tree

### 将style sheet文件经过css parse形成一个css的树状结构

## render tree

### 将DOM与CSSOM结合形成render tree

## layout

### 利用render tree，浏览器知道了有哪些节点，以及节点css属性，和节点的从属关系，从而去计算每个节点在屏幕里的位置

## painting

### 按照算出来的规则，通过显卡，把内容画到屏幕上。

## reflow 回流

### 当浏览器发现某个部分发生了点变化影响了布局，需要倒回去重新渲染

### 影响因素

- 1. display： none  
2. 懒加载
3.  获取元素的offsetTop， offsetLeft, offsetHeight, offsetWidth属性
4. 使用calc来修改css样式
- 页面上某些元素的占位面积、定位方式、边距等属性的变化
- 避免： 
1. 避免直接修改样式，应该统一为一次修改，或则使用css class来修改
2. 缓存layout的值。var left = ele.offsetLeft; 多次使用left也就产生一次reflow。
3. 设置元素的position的属性为absolute 或者fixed 。元素脱离标准流也就从DOM Tree中脱离出来，在需要reflow的时候只需要reflow自身以及下级元素。
4. 尽量不要使用table布局。table元素一旦触发reflow就会导致table里所有的其它元素 reflow。在适合用table的场合，可以设置table-layout为auto或fixed，这样可以让table一行一行的渲染，这种做法也是为了限制reflow的影响范围

## repaint 重绘

### 改变某个元素的背景色、文字颜色、边框颜色等等不影响它周围或内部布局的属性时，屏幕的一部分要重画，但是元素的几何尺寸没有变

### visibility: hidden

## 浏览器回流一定会发生重绘，但重绘不一定发生回流

